(this["webpackJsonppersonalization-example"]=this["webpackJsonppersonalization-example"]||[]).push([[0],{172:function(e,t,n){},174:function(e,t,n){},272:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(32),i=n.n(r),s=(n(172),n(173),n(174),n(5)),o=n(78),l=n(48),u=n(274),j=n(2),d=n(277),b=n(276),x=n(279),O=n(77),p=n(36),m=n.n(p),h=n(47),f=n(154),v=n.n(f),g=function(){var e=Object(h.a)(m.a.mark((function e(t,n){var c,a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="https://web.popmechanic.ru/web/init/".concat(t,"/?domain=").concat(n),e.next=3,v.a.get(c);case 3:return a=e.sent,r=a.data.forms,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=n(7),S=function(e){var t=e.updateFormsInfo,n=e.nextStep,a=Object(c.useState)({id:"",domain:""}),r=Object(s.a)(a,2),i=r[0],o=r[1],l=d.a.Text,u=d.a.Title;return Object(w.jsxs)("div",{children:[Object(w.jsx)(u,{level:4,children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0444\u043e\u0440\u043c"}),Object(w.jsxs)(b.a,{layout:"vertical",onFinish:function(e){g(i.id,i.domain).then((function(e){console.log("Success:",e),e&&t(e)})).catch((function(e){return console.log(e)})).finally((function(){return n()}))},children:[Object(w.jsx)(b.a.Item,{label:"\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0432 \u043f\u043e\u043f\u043c\u0435\u0445\u0430\u043d\u0438\u043a\u0430\u0445",children:Object(w.jsx)(x.a,{placeholder:"\u0418\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440",value:i.id,onChange:function(e){return o(Object(j.a)(Object(j.a)({},i),{},{id:e.target.value}))}})}),Object(w.jsx)(b.a.Item,{label:"\u0414\u043e\u043c\u0435\u043d \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f, \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u0432 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430\u0445 \u0444\u043e\u0440\u043c\u044b",children:Object(w.jsx)(x.a,{placeholder:"\u0414\u043e\u043c\u0435\u043d",value:i.domain,onChange:function(e){return o(Object(j.a)(Object(j.a)({},i),{},{domain:e.target.value}))}})}),Object(w.jsx)(b.a.Item,{children:Object(w.jsx)(O.a,{type:"primary",htmlType:"submit",children:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0444\u043e\u0440\u043c"})})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)(u,{level:4,children:"URL \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438\u043d\u0444\u043e\u043c\u0440\u0430\u0446\u0438\u0438 \u043e \u0444\u043e\u0440\u043c\u0430\u0445"}),Object(w.jsx)(l,{code:!0,style:{whiteSpace:"nowrap"},children:"https://web.popmechanic.ru/web/init/".concat(i.id,"/?domain=$").concat(i.domain)})]})]})},I=n(6),y=n(127),k=Object(y.a)();Object(y.b)({}).on(k,(function(e,t){var n=t.field,c=t.value;return Object(j.a)(Object(j.a)({},e),{},Object(I.a)({},n,c))}));var N=n(280),E=(n(262),function(e){var t=e.url;return Object(w.jsx)("div",{children:Object(w.jsx)("img",{src:t,alt:"",style:{maxWidth:"100%"}})})}),R=function(e){var t=e.bannerImageUrl;return Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:"device-wrapper",children:Object(w.jsxs)("div",{className:"device","data-device":"iPhone7","data-orientation":"portrait","data-color":"black",children:[Object(w.jsxs)("div",{className:"screen",style:{backgroundColor:"white",padding:"15px 10px"},children:[Object(w.jsx)(N.a,{}),t&&Object(w.jsx)(E,{url:t})]}),Object(w.jsx)("div",{className:"button"})]})})})},T=n(278),_=[{title:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0444\u043e\u0440\u043c\u044b",description:"\u041f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0445 \u0444\u043e\u0440\u043c, \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0432 GET \u0437\u0430\u043f\u0440\u043e\u0441"},{title:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0442\u0430\u0440\u0433\u0435\u0442\u0438\u043d\u0433",description:"\u0415\u0441\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d \u0442\u0430\u0440\u0433\u0435\u0442\u0438\u043d\u0433 \u043f\u043e \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0443, \u043f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u043f\u0440\u0438\u043d\u0430\u0434\u043b\u0435\u0436\u0438\u0442 \u043b\u0438 \u043a\u043b\u0438\u0435\u043d\u0442 \u043a \u043d\u0443\u0436\u043d\u043e\u043c\u0443"},{title:"\u041e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u0435 \u0444\u043e\u0440\u043c\u044b",description:"\u0415\u0441\u043b\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u043e\u0434\u0445\u043e\u0434\u0438\u0442 \u043f\u043e\u0434 \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u043d\u0430\u0434\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0437\u0438\u0442\u044c \u0435\u043c\u0443 \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u0442\u0435\u043d\u0442"}],C=function(e){var t=e.currentStep,n=T.a.Step;return Object(w.jsx)(T.a,{direction:"vertical",current:t,children:_.map((function(e){return Object(w.jsx)(n,{title:e.title,description:e.description},e.title)}))})},A=n(284),F=function(e,t){var n=e.value,c=n.inSegment,a=n.inSegmentByDefault;return!(void 0!==t||!a)||(!(!c||!t)||!c&&!t)},M=function(e,t){return new Promise((function(n,c){window.mindbox("sync",{operation:t,data:{segmentations:[{ids:{externalId:e}}]},onSuccess:function(e){n(z(e))},onValidationError:function(e){c(e)},onError:function(e){c(e)}})}))},z=function(e){if(e.customerSegmentations)return!!e.customerSegmentations[0].segment},D=n(275),P=n(283),B=n(282),q=function(e){var t=e.formInfo,n=e.showInResult,a=e.nextStep,r=Object(c.useState)(!1),i=Object(s.a)(r,2),o=i[0],l=i[1],u=function(e){var t,n,c,a=null===(t=e.new_targeting)||void 0===t||null===(n=t.filter)||void 0===n?void 0:n.nodes;return e&&e.settings_splits&&e.settings_splits[0]&&(c=e.settings_splits[0].settings),{targeting:a,views:c}}(t),j=u.targeting,d=u.views,b=Object(c.useState)(!1),x=Object(s.a)(b,2),p=x[0],f=x[1],v=Object(c.useState)(null),g=Object(s.a)(v,2),S=g[0],I=g[1],y=function(){var e=Object(h.a)(m.a.mark((function e(){var t,n,c,r,i,o,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a(),!j){e.next=12;break}return t=Object(s.a)(j,1),n=t[0],c=n.value,r=c.segmentation,i=c.operation,f(!0),e.next=7,M(r,i);case 7:o=e.sent,I(o),u=F(n,o),l(u),f(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsx)(D.a,{title:t.name,actions:[Object(w.jsx)(O.a,{type:"link",loading:p,size:"small",onClick:y,children:"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u0441\u0435\u0433\u043c\u0435\u043d\u0442"},"checkSegment"),d&&Object(w.jsx)(O.a,{type:"link",size:"small",disabled:!o,onClick:function(){return n(d.image)},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c"},"showINResult")],children:Object(w.jsxs)(P.b,{bordered:!0,size:"small",children:[Object(w.jsx)(P.b.Item,{label:"\u0422\u0438\u043f \u0442\u0430\u0440\u0433\u0435\u0442\u0438\u043d\u0433\u0430",span:3,children:j&&j.length&&j[0].field}),j&&j.length&&"mindbox_segment"===j[0].field&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(P.b.Item,{label:"\u0414\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0432 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0435",span:3,children:j[0].value.inSegment?"\u0414\u0430":"\u041d\u0435\u0442"}),Object(w.jsx)(P.b.Item,{label:"\u0427\u0442\u043e \u0434\u0435\u043b\u0430\u0442\u044c, \u0435\u0441\u043b\u0438 \u043d\u0435 \u043d\u0430\u0448\u043b\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430",span:3,children:j[0].value.inSegmentByDefault?"\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c":"\u041d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c"})]}),null!==S&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(P.b.Item,{label:"\u0421\u0442\u0430\u0442\u0443\u0441 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0430 \u043a\u043b\u0438\u0435\u043d\u0442\u0430",span:3,children:void 0===S?Object(w.jsx)(B.a,{status:"warning",text:"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d \u0432 Mindbox"}):S?Object(w.jsx)(B.a,{status:"success",text:"\u0412 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0435"}):Object(w.jsx)(B.a,{status:"error",text:"\u041d\u0435 \u0432 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0435"})}),Object(w.jsx)(P.b.Item,{label:"\u041f\u043e\u043f\u0430\u0434\u0430\u0435\u0442 \u0432 \u0442\u0430\u0440\u0433\u0435\u0442\u0438\u043d\u0433",span:3,children:o?Object(w.jsx)(B.a,{status:"success",text:"\u041f\u043e\u043f\u0430\u0434\u0430\u0435\u0442"}):Object(w.jsx)(B.a,{status:"error",text:"\u041d\u0435 \u043f\u043e\u043f\u0430\u0434\u0430\u0435\u0442"})})]})]})})},J=n(281),U={parsed:"\u041a\u0430\u0440\u0442\u043e\u0447\u043a\u0438",raw:"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043e\u0434"},W=function(e){var t=e.changeMode,n=e.currentMode;return Object(w.jsx)(J.a.Group,{options:Object.values(U),onChange:function(e){return t(e.target.value)},value:n,optionType:"button",buttonStyle:"solid"})},G=n(164),L=n.n(G),V=(n(270),n(271),function(e){var t=e.rawData,n=t.length>0?JSON.stringify(t,null,2):"";return Object(w.jsx)(L.a,{mode:"json",theme:"github",value:n,name:"PREVIEW_RAW_PERSONALIZATION_DATA",editorProps:{$blockScrolling:!0}})}),$=function(e){var t=e.forms,n=e.showResult,a=e.nextStep,r=d.a.Title,i=Object(c.useState)(U.parsed),o=Object(s.a)(i,2),l=o[0],u=o[1];return Object(w.jsxs)(A.b,{direction:"vertical",children:[Object(w.jsx)(r,{level:4,children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0435 \u0444\u043e\u0440\u043c\u044b"}),Object(w.jsx)(W,{changeMode:u,currentMode:l}),l===U.parsed?Object(w.jsx)(A.b,{direction:"vertical",children:t.map((function(e){return Object(w.jsx)(q,{formInfo:e,showInResult:n,nextStep:a},e.id)}))}):Object(w.jsx)(V,{rawData:t})]})},Z=function(){var e=Object(c.useState)(0),t=Object(s.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),i=Object(s.a)(r,2),j=i[0],d=i[1],b=Object(c.useState)([]),x=Object(s.a)(b,2),O=x[0],p=x[1];return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(o.a,{children:[Object(w.jsx)(l.a,{flex:"330px",children:Object(w.jsx)(R,{bannerImageUrl:j})}),Object(w.jsxs)(l.a,{flex:"3",children:[Object(w.jsx)(u.a,{className:"site-page-header",title:"\u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f"}),Object(w.jsxs)(o.a,{gutter:{xs:8,sm:16,md:24},children:[Object(w.jsx)(l.a,{flex:"330px",children:Object(w.jsx)(C,{currentStep:n})}),Object(w.jsxs)(l.a,{flex:"3",children:[0===n&&Object(w.jsx)(S,{updateFormsInfo:p,nextStep:function(){return a(1)}}),(1===n||2===n)&&O&&Object(w.jsx)($,{forms:O,showResult:function(e){console.log(e),d(e)},nextStep:function(){return a(2)}})]})]})]})]})})};var H=function(){return Object(c.useEffect)((function(){!function(){window.mindbox=window.mindbox||function(){window.mindbox.queue.push(arguments)},window.mindbox.queue=window.mindbox.queue||[],window.mindbox("create",{endpointId:"wpush-test"});var e=document.createElement("script");e.src="https://api.mindbox.ru/scripts/v1/tracker.js",document.getElementsByTagName("head")[0].appendChild(e)}()}),[]),Object(w.jsx)("div",{className:"App",children:Object(w.jsx)(Z,{})})};i.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(H,{})}),document.getElementById("root"))}},[[272,1,2]]]);
//# sourceMappingURL=main.d00749c3.chunk.js.map